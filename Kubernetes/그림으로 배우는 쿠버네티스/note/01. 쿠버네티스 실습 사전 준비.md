## Pod/파드, 컨테이너, 애플리케이션 용어 정리

`파드(Pod)`는 쿠버네티스에서 가장 작은 배포 단위이다. 하나의 파드에 여러 개의 컨테이너(주로 Docker 컨테이너)를 포함할 수 있지만 특수한 경우를 제외하고는 하나의 컨테이너로 사용되는 편이다.
파드 내부의 컨테이너들은 같은 네트워크(IP, 포트)와 스토리지(볼륨)를 공유하는 특징이 있다.

`볼륨(Volume)`은 파드 내 컨테이너들이 공유하는 저장 공간이다. 컨테이너가 재시작되어도 데이터가 유지되어야할 때 볼륨이 필요하며,
파드가 삭제되면 볼륨도 함께 삭제되지만, 일부 영속적 볼륨 유형은 예외적으로 데이터를 계속 보존할 수 있다.

파드내의 컨테이너들은 볼륨 공간을 공유하기에 여러 컨테이너의 데이터 공유에서 유용하게 활용될 수 있다.

쿠버네티스 환경에서 하나의 파드와 그 안의 볼륨, 그리고 포함된 컨테이너 전체를 하나의 애플리케이션으로 부르기도 한다.
실무에서는 파드 여러 개, 즉 여러 인스턴스로 애플리케이션을 구성하는 경우가 많지만 논리적으로 파드, 볼륨, 컨테이너를 묶어서 하나의 단위로 보는 경우도 흔하다.
이러한 관점은 애플리케이션 배포와 관리를 단순화하는 데 도움이 된다.

## 자주 사용되는 kubectl 옵션 명령어
`kubectl`은 쿠버네티스 클러스터를 관리하기 위한 커맨드 라인 도구이다. 클러스내 내의 다양한 리소스를 생성, 조회, 수정, 삭제할 수 있다.
쿠버네티스 핵심인 API 서버와 직접 통신하여 명령을 클러스터에 전달하며 명령형와 선언형 모두를 지원한다. 

```text
쿠버네티스의 핵심 개념은 여러 대의 서버(node)를 묶어서 하나의 클러스터로 관리하는 것이다.
마스터 노드(Control Plane)와 워커 노드(Worker Node)로 분류할 수 있다.
테스트나 학습 용도로 사용되는 싱글 노드 쿠버네티스도 클러스터 구조를 유지한다.
```

### get

쿠버네티스 리소스(파드, 서비스, 디플로이먼트 등)의 목록이나 상태를 조회한다.

```shell
kubectl get pods # 파드 목록 조회 
kubectl get svc  # 서비스 목록 조회
kubectl get all  # 전체 리소스 목록 조회
```

### run

새로운 파드를 생성하고 실행한다. 과거에는 다양한 리소스를 생성할 수 있었지만 역할이 축소되며 거의 사용하지 않게 되었다.

```shell
kubectl run nginx --image=nginx
```

### create
yaml 파일을 지정하거나 명령어를 통해 쿠버네티스 리소스를 생성한다. 명령형 방식으로 최근에는 사용빈도가 줄어들고 있다.
명령형 방식은 리소스 생성을 즉시 수행하지만, 변경 사항을 업데이트 해주지 않는 특징이 있다.
하지만 namespace, secret, configmap 등의 리소스 생성에는 여전히 사용되고 있다.
```shell
kubectl create -f deployment.yaml
kubectl create namespace my-namespace
```

### apply 
yaml 파일을 적용하여 리소스를 생성하거나, 이미 있으면 변경사항을 반영한다. 선언적 관리 방식으로 동작한다.
```shell
kubectl apply -f deployment.yaml
```

### delete 
리소스를 삭제한다. 단일 리소스를 지정하거나 yaml 파일을 지정할 수 있다.
```shell
kubectl delete pod nginx-pod
kubectl delete -f deployment.yaml
```

### exec
실행 중인 파드 내 컨테이너에 명령어를 실행한다. 
```shell
kubectl exec -it nginx-pod -- /bin/bash
```

### scale 
Deployment, ReplicaSet 등의 파드 개수를 조정한다. (스케일 업/다운)
```shell
kubectl scale deployment nginx-deployment --replicase=5
```

### edit
리소스의 설정을 에디터에서 직접 수정한다. 명령형으로 동작한다.
```shell
kubectl edit deployment nginx-deployment
```

### --output
명령어의 출력 형식을 지정할 때 사용되며 yaml, json, wide, name 등의 형식을 지원한다.
```shell
kubectl get pod mypod -o yaml # 파드 조회 결과를 yaml 형식으로 출력
```

### --dry-run=client
실제로 리소스를 생성하거나 변경하지 않고, 명령을 실행했을 때 어떤 결과가 나올지 미리 확인하는 기능이다.
이를 통해 실수로 리소스를 잘못 생성하거나 수정하는 일을 방지할 수 있으며, 사전 검증에서 주로 사용된다.

```shell
kubectl create deployment nginx --image=nginx --dry-run=client -o yaml
# -o 옵션과 함께 사용되는 편이다.
```

### event
클러스터 내에서 발생한 다양한 이벤트(파드 생성, 실패, 스케줄링 등)를 시간순으로 보여준다. 리소스 문제에 대한 원인을 파악하는데 유용하다.
```shell
kubectl get events
```

### describe 
특정 리소스의 상세 정보를 확인할 수 있다. 
```shell
kubectl describe pod mypod
```

### logs
파드 내 컨테이너에서 출력한 로그를 확인할 수 있다. -f 옵션을 통해 실시간으로 확인할 수 있다.
다른 명령어와 파이프로 연결하여 파일로 저장하는 것도 유용하게 사용된다.
```shell
kebuctl logs -f mypod
kubectl logs -f [파드이름] > logs.txt # 새 파일로 저장
kubectl logs -f [파드이름] | grep "WARN" > warn.log # 실시간으로 특정 패턴만 새 파일로 저장

```