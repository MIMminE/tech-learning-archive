## 애플리케이션으로 배포되는 오브젝트 형태

쿠버네티스에서 오브젝트란 클러스터에 생성되어 관리되는 모든 리소스의 기본 단위를 의미하며
yaml 파일로 정의되어 kubectl 명령어나 API로 클러스터에 생성/수정/삭제될 수 있다.

쿠버네티스에서는 주로 원하는 오브젝트 상태를 `선언`하면 쿠버네티스가 그 상태를 맞추는 형태로 운영되며 오브젝트 상태는 etcd(쿠버네티스 저장소)에 저장된다.

여기서는 애플리케이션을 배포하기 위해 사용되는 쿠버네티스 오브젝트에 대하여 살펴본다.

## 파드(Pod)

쿠버네티스에서 애플리케이션 배포의 기본 단위이다.

```yaml
# sample_pod.yaml
apiVersion: v1
kind: Pod
metadata:
  labels:
    run: po-nginx
  name: po-nginx
spec:
  containers:
    - image: nginx
      name: nginx
```

- `metadata`: 오브젝트를 식별하는 정보를 담으며, 주로 이름과 라벨이 사용된다. 라벨은 키-값 쌍으로 붙일 수 있고, 이후 selector 등에 의해 식별되어 트래픽을 주거나 받거나 할 수 있다.
- `spec`: 이 파드가 어떤 컨테이너로 구성되어 있는지, 어떻게 동작해야 하는지 정의한다. 도커 허브의 최신 nginx 이미지를 사용하고 컨테이너 이름을 nginx로 사용한다고 정의한 것이다.

이렇게 선언되어 있는 쿠버네티스 오브젝트에 대한 내용을 기억하며 이 상태대로 유지하려고 하는 것이 쿠버네티스의 기본 동작 메커니즘이다.
이를 `선언적(Declarative) 방식`이라 하며, 사용자가 원하는 상태(Desired State)를 선언하면 내부적으로 eted에 저장하고 있다가 Controller 가 오브젝트와 원하는 상태를 계속 비교하며
싱크를 맞추려 노력하게 된다.

## 디플로이먼트(Deployment)

```yaml
# deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app: deploy-nginx
  name: deploy-nginx
spec:
  replicas: 3
  selector:
    matchLabels:
      app: po-nginx # template 에서 정의할 라벨과 일치해야 한다.
  template:
    metadata:
      labels:
        app: po-nginx # selector 에서 정의할 라벨과 일치해야 한다.
    spec:
      containers:
        - name: nginx
          image: nginx
```

디플로이먼트의 `spec.template` 부분은 관리할 파드를 선언하고 있는 것이다.
또한 `selector`로 지정한 라벨과 `template`에서 정의된 파드의 라벨을 일치시키는 것은 관행이자 필수이다.
여기서 라벨로써 지정된 파드를 디플로이먼트의 관리 대상으로 인식하게 된다.

template 은 다른 오브젝트 정의에서도 등장하지만 내부적으로 사용할 오브젝트(주로 파드)를 정의하는데 이용된다. 

## 레플리카셋(ReplicaSet)

## 커맨드(command)와 인자(args)

## 잡(Job)

## 크론잡(CronJob)

## 데몬셋(DaemonSet)

## 스테이트풀셋(StatefulSet)

